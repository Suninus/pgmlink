VERSION = 1
SUBVERSION = 2
ANN_VERSION = 1.1.2
LP_SOLVE_VERSION = 5
LP_SOLVE_SUBVERSION = 5
ARCHITECTURE = ux64

TRACK = track2_${VERSION}.${SUBVERSION}
TESTLIBS = test_libs_${VERSION}.${SUBVERSION}
TRACKOBJS = ${TRACK}.o
TESTLIBSOBJS = ${TESTLIBS}.o
SRC = src/track2_${VERSION}.${SUBVERSION}.cpp
SRC_TESTLIBS = src/test_libs_${VERSION}.${SUBVERSION}.cpp
FLAGS_STD = 

INCLUDES = -I${PWD}/../3rd_party/include

RPATH = ${PWD}/../3rd_party/lib

LIBPATH = -L${RPATH}

LIBS = -lhdf5 -lhdf5_hl -lANN 
LIBS_STD = -llpsolve${LP_SOLVE_VERSION}${LP_SOLVE_SUBVERSION}

all : ${TRACK} ${TESTLIBS}
	mv ${TRACK} bin
	mv ${TESTLIBS} bin

${TRACK} : ${TRACKOBJS}
	${CXX} -o $@ ${TRACKOBJS} ${LIBPATH} ${LIBS} ${LIBS_STD} -Wl,-rpath,${RPATH}

${TESTLIBS} : ${TESTLIBSOBJS}
	${CXX} -o $@ ${TESTLIBSOBJS} ${LIBPATH} ${LIBS} ${LIBS_STD} -Wl,-rpath,${RPATH}

${TRACKOBJS} : ${SRC}
	${CXX} -c ${INCLUDES} ${FLAGS_STD} -o $@ $<

${TESTLIBSOBJS} : ${SRC_TESTLIBS}
	${CXX} -c ${INCLUDES} -o $@ $<

clean :
	! (test -e ${TRACKOBJS}) || rm ${TRACKOBJS} 
	! (test -e ${TESTLIBSOBJS}) || rm ${TESTLIBSOBJS} 
	! (test -e bin/${TRACK}) || rm bin/${TRACK}
	! (test -e bin/${TESTLIBS}) || rm bin/${TESTLIBS}
